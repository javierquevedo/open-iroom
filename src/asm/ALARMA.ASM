
org	1200h


ALARMA_INIT:
	CLR	ALARMA_PEND
	MOV	ALARMA_HORA,#0
	MOV	ALARMA_MINUTO,#0
	CLR	ALARMA_STATUS
		RET
	

ALARMA_CHECK:
		PUSH	ACC
		PUSH	PSW
		MOV	A,CLK_MIN
		CJNE	A,ALARMA_MINUTO,AC_EXIT
		MOV	A,CLK_HORAS
		CJNE	A,ALARMA_HORA,AC_EXIT
		
		SETB	ALARMA_PEND
AC_EXIT:		
	POP	PSW
	POP	ACC
	RET
	;; SE DEBERIA DE HACER LLAMANDO A LAS FUNCIONES
	;; DE ACCION, PERO NO SE PUEDE, HABRIA QUE REESCRIBIRLAS
	;; YA QUE ESTAS ESTAN DENTRO DE ACCION_UPDATE
	;; Y NO SE PUEDEN USAR INDIVIDUALMETNE
ALARMA_UPDATE :
	JNB	ALARMA_STATUS,AU_ST4
	SETB	LCD_PEND_INFO
	JNB	ALARMA_MOTOR_01,AU_ST1
	LCALL	EJECUTAR_IM1I
AU_ST1:	JNB	ALARMA_LUZ_01,AU_ST2

	SETB	LUZ_01
AU_ST2: JNB	ALARMA_LUZ_02,AU_ST3
	SETB	LUZ_02
AU_ST3:	JNB	ALARMA_MOTOR_02,AU_ST4
	LCALL	EJECUTAR_IM2I

AU_ST4:	CLR	ALARMA_PEND
	RET


