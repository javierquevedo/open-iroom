;		TECLADO 
	
ORG 1100H
TECLADO_UPDATE:
	PUSH	ACC
	SETB	COL2
	SETB	COL3
	CLR	COL1

	;; COMPROBAMOS 5 VECES PARA EVITAR EL REBOTE
	MOV	A,#TECLADO_REBOTES

	JB	FIL1,TU_1B
	DJNZ	ACC,$-3
	;1.1
	NOP
	LJMP	TECLADO_EXIT

TU_1B:	MOV	A,#TECLADO_REBOTES
	JB	FIL2,TU_1C
	DJNZ	ACC,$-3
	; 2.1			
	SETB	MENU_PEND
	SETB	MENU_PEND_LEFT
	MOV	TECLADO_COUNT,#TECLADO_PULSADO
	LJMP	TECLADO_EXIT
	
TU_1C:	MOV	A,#TECLADO_REBOTES
	JB	FIL3,TU_2A
	DJNZ	ACC,$-3
	;; 3.1
	NOP
	LJMP	TECLADO_EXIT

TU_2A:  SETB	COL1
	CLR	COL2
	SETB	COL3
	
	MOV	A,#TECLADO_REBOTES
	JB	FIL1,TU_2B
	DJNZ	ACC,$-3
	;2.1
	SETB	MENU_PEND
	SETB	MENU_PEND_UP
	MOV	TECLADO_COUNT,#TECLADO_PULSADO
	LJMP	TECLADO_EXIT

TU_2B:	MOV	A,#TECLADO_REBOTES
	JB	FIL2,TU_2C
	DJNZ	ACC,$-3
	;2.2
	SETB	ACCION_PEND
	MOV	TECLADO_COUNT,#TECLADO_PULSADO
	LJMP	TECLADO_EXIT

TU_2C:	MOV	A,#TECLADO_rEBOTES
	JB	FIL3,TU_3A
	DJNZ	ACC,$-3
	;2.3
	SETB	MENU_PEND
	SETB	MENU_PEND_DOWN
	MOV	TECLADO_COUNT,#TECLADO_PULSADO
	LJMP	TECLADO_EXIT
TU_3A:	SETB	COL1
	SETB	COL2
	CLR	COL3

	MOV	A,#TECLADO_REBOTES
	JB	FIL1,TU_3B
	DJNZ	ACC,$-3
	;;3.1
	NOP
	LJMP	TECLADO_EXIT

TU_3B:	MOV	A,#TECLADO_REBOTES
	JB	FIL2,TU_3C
	DJNZ	ACC,$-3
	;; 3.2
	SETB	MENU_PEND
	SETB	MENU_PEND_RIGHT
	MOV	TECLADO_COUNT,#TECLADO_PULSADO
	LJMP	TECLADO_EXIT

TU_3C:	MOV	A,#TECLADO_REBOTES
	JB	FIL3,TU_END
	DJNZ	ACC,$-3
	;; 3.3
	NOP
	LJMP	TECLADO_EXIT
TU_END:	
	MOV	TECLADO_COUNT,#2
TECLADO_EXIT:	
	CLR	TECLADO_PEND
	POP	ACC
	ret


	